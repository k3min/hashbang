(function(e){var f=e.location,g=e.document.documentElement,a=e.HA={version:"0.0.2",endpoint:"api/",main:function(){a.request=new HB.Request(a.endpoint);a.request.get({success:a.sync,error:a.error})},create:function(b,c){var d={type:b};switch(b){case a.TYPE.COLLECTION:d.key="handle";d.value="new";break;case a.TYPE.BLOCK:d.key="collectionId",d.value=c}a.request.send({method:"POST",data:d})},sync:function(b){var c=e.overview;for(a.metadata={attributes:b.attributes,collections:b.collections,tags:b.tags};c.firstChild;)c.removeChild(c.firstChild);
for(;tags.firstChild;)tags.removeChild(tags.firstChild);for(;attributes.firstChild;)attributes.removeChild(attributes.firstChild);c.appendChild(e.nav.render(b.collections));tags.appendChild(e.datalist.render(b.tags));attributes.appendChild(e.datalist.render(b.attributes));void 0===HB.root?(HB.noCache=!0,HB.main(),HB.root.addEventListener("update",a.root,!1),HB.root.addEventListener("change",a.save,!1)):void 0!==b.target&&(f.hash=b.target)},root:function(b){b=b.detail;var c=void 0!==b.block;a.target=
{type:c?a.TYPE.BLOCK:a.TYPE.COLLECTION,id:+(c?b.search("handle",b.block).blocks[0]:b).id}},save:function(b){b.target.validity.valid&&a.request.send({method:"POST",data:{type:a.target.type,id:a.target.id,key:b.target.name,value:b.target.value}})},"delete":function(){confirm(a.strings["delete"].format(a.target.type))&&a.request.send({method:"DELETE",data:{type:a.target.type,id:a.target.id}})},error:function(b){g.classList.add("error");alert(a.strings[b.status]||a.strings.error)},find:function(a,c){for(var d in a)return c.handle===
d&&c.title===a[d];return!1},logout:function(){a.request.error=null;a.request.xhr.open("HEAD",":protocol//logout@:host:port:pathname".format(f)+a.endpoint);a.request.xhr.send()},TYPE:{COLLECTION:"collection",BLOCK:"block"},strings:{"delete":"Are you sure you want to delete this {}? This action cannot be undone.",error:"Something went wrong!",400:"Something went seriously wrong!",401:"You are not authorized!",500:"Something went wrong on the server!"}};HB.Request.prototype.send=function(b){g.classList.add("loading");
this.success=a.sync;this.error=a.error;this.xhr.open(b.method,this.endpoint,!0);this.xhr.setRequestHeader("Content-Type","application/json");this.xhr.send(JSON.stringify(b.data))}})(this);