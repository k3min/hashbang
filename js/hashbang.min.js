(function(f){var d=f.document,e=f.HB={version:"2.0.0",endpoint:"api/:handle",collections:{},main:function(){this.request=new p(this.endpoint);this.home=d.links[0].hash;this.root=f.root;this.title={text:d.title,spec:d.getElementsByTagName("title")[0].dataset.spec};this.router.add("/:collection",function(a){void 0===e.collections[a]?e.request.get({handle:a},function(b){e.collections[a]=new q;e.collections[a].load(b);e.root.appendChild(e.collections[a])}):e.root.appendChild(e.collections[a])});this.router.match()}},
g=f.klass=function(a){var b=a.constructor;void 0!==this.prototype&&(b.prototype=Object.create(this.prototype,{parent:{value:this.prototype}}));for(var c in a){var r=c.split("$")[0],d=/static/.test(c)?b:b.prototype;Object.defineProperty(d,r,{enumerable:!/hidden|constructor/.test(c),value:a[c]})}return b};Object.defineProperty(Object.prototype,"extend",{value:g});void 0===d.registerElement&&(d.registerElement=function(a,b){d.registerElement.list[a]=b;var c=function(){var c=d.createElement(a);c.__proto__=
b.prototype;void 0!==c.createdCallback&&c.createdCallback.call(a);return c};c.prototype=b.prototype;Object.defineProperty(c.prototype,"constructor",{value:c});return c},d.registerElement.list={},d.addEventListener("DOMContentLoaded",function(){var a=[],b=d.registerElement.list,c;for(c in b)a.push(b[c]["extends"]?"{}[is={}]".format(b[c]["extends"],c):c);Array.apply(null,d.querySelectorAll(a.join(","))).forEach(function(a){a.__proto__=b[c].prototype;void 0!==a.createdCallback&&a.createdCallback.call(a)})},
!1));void 0===f.HTMLTemplateElement&&(f.HTMLTemplateElement=HTMLElement.extend({constructor:function(){this.parent.constructor.apply(this,arguments)}}));var l=e.Template=d.registerElement("hb-template",{prototype:Object.create(HTMLTemplateElement.prototype,{createdCallback:{value:function(){var a=this.innerHTML,a=a.replace(/\s{2,}/g,""),a=a.replace(/\{\{(.*?)\}\}/g,"',$1,'"),a=a.split("{%").join("');"),a=a.split("%}").join("a.push('"),a="var a=[];a.push('{}');return a.join('');".format(a);this.source=
new Function(a)}},render:{value:function(a){return this.source.call(a)}}}),"extends":"template"});l.list={};var q=e.Collection=d.registerElement("hb-collection",{prototype:Object.create(HTMLElement.prototype,{load:{value:function(a){this.id=a.id;this.handle=a.handle;this.title=a.title;this.type=a.type;this.template=f[a.type];this.blocks=a.blocks.map(function(a){return new s(a)});void 0!==this.template?this.insertAdjacentHTML("beforeend",this.template.render(this)):console.error("Template '{}' is not defined".format(a.type))}}})}),
s=e.Block=g({constructor:function(a){for(var b in a)this[b]=a[b];this.time=new Date(this.time);this.template=l.list[this.type]},reduce:function(a){a=a.split(".");var b=this[a[0]];if(void 0!==a[1])for(var c=1;c<a.length;c++)b=b[a[c]];return b}}),t=e.Router=g({constructor:function(){f.addEventListener("hashchange",this.match.bind(this),!1)},add$hidden:function(a,b){this[a]=b;this[a].match=new RegExp(a.replace(/:\w+/g,"(\\w+)"))},match$hidden:function(){for(var a in this){var b=location.hash.match(this[a].match);
null!==b&&(b.shift(),this[a].apply(this,b))}}});e.router=new t;var p=e.Request=g({constructor:function b(c){this.endpoint=c;this.xhr=new XMLHttpRequest;this.xhr.addEventListener("load",b.load.bind(this),!1)},get:function(b,c){this.callback=c;this.xhr.open("GET",this.endpoint.format(b),!0);this.xhr.setRequestHeader("Accept","application/json");this.xhr.send(null);d.body.classList.add("loading")},load$static:function(){200===this.xhr.status&&this.callback.call(this,JSON.parse(this.xhr.response));d.body.classList.remove("loading")}});
String.prototype.format=function(b){var c=0;"object"!==typeof b&&(b=[].slice.call(arguments));return this.replace(/:(\w+)|\{([0-9])?\}/g,function(d,e,h){return b[e||h||c++]})};Date.prototype.format=function(b){var c=Date.ordinals,d=this.getDate(),e=this.getDay(),h=this.getMonth(),f=this.getFullYear(),k=this.getHours(),g=k%12||12,m=this.getMinutes(),n=this.getSeconds(),l={d:10>d?"0"+d:d,D:Date.days[e].substr(0,3),j:d,l:Date.days[e],N:e||7,S:3<d&&20>=d?c[0]:c[d%10]||c[0],w:e,F:Date.months[h],m:10>h?
"0"+(h+1):h+1,M:Date.months[h].substr(0,3),n:h+1,t:(new Date(f,h+1,0)).getDate(),Y:f,y:(""+f).substr(2,2),a:12>k?"am":"pm",A:12>k?"AM":"PM",g:g,G:k,h:10>g?"0"+g:g,H:10>k?"0"+k:k,i:10>m?"0"+m:m,s:10>n?"0"+n:n};return b.replace(/\\?([a-z])/gi,function(b,c){return void 0!==l[b]?l[b]:c})};Date.ordinals=["th","st","nd","rd"];Date.days="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");Date.months="January February March April May June July August September October November December".split(" ")})(this);