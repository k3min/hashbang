(function(f){var d=f.document,e=f.HB={version:"2.0.0",endpoint:"api/:handle",collections:{},main:function(){this.request=new q(this.endpoint);this.home=d.links[0].hash;this.root=f.root;this.title={text:d.title,spec:d.getElementsByTagName("title")[0].dataset.spec};this.router.add("/:collection",function(a){void 0===e.collections[a]?e.request.get({handle:a},function(c){e.collections[a]=new r;e.collections[a].load(c);e.root.appendChild(e.collections[a])}):e.root.appendChild(e.collections[a])});this.router.match()}},
g=f.klass=function(a){var c=a.constructor;void 0!==this.prototype&&(c.prototype=Object.create(this.prototype,{parent:{value:this.prototype}}));for(var b in a){var n=b.split("$")[0],d=/\$static/.test(b)?c:c.prototype,e=!/\$hidden|constructor/.test(b);a[b].get||a[b].set?Object.defineProperty(d,n,{enumerable:e,get:a[b].get,set:a[b].set}):Object.defineProperty(d,n,{enumerable:e,value:a[b]})}return c};Object.defineProperty(Object.prototype,"extend",{value:g});void 0===d.registerElement&&(d.registerElement=
function(a,c){d.registerElement.elements[a]=c;var b=function(){var b=d.createElement(a);b.__proto__=c.prototype;void 0!==b.createdCallback&&b.createdCallback.call(a);return b};b.prototype=c.prototype;Object.defineProperty(b.prototype,"constructor",{value:b});return b},d.registerElement.elements={},d.addEventListener("DOMContentLoaded",function(){var a=[],c=d.registerElement.elements,b;for(b in c)a.push(c[b]["extends"]?"{}[is={}]".format(c[b]["extends"],b):b);Array.apply(null,d.querySelectorAll(a.join(","))).forEach(function(a){a.__proto__=
a[b].prototype;void 0!==a.attachedCallback&&a.attachedCallback.call(a)})},!1));void 0===f.HTMLTemplateElement&&(f.HTMLTemplateElement=HTMLElement.extend({constructor:function(){this.parent.constructor.apply(this,arguments)}}));e.Template=d.registerElement("hb-template",{prototype:Object.create(f.HTMLTemplateElement.prototype,{attachedCallback:{value:function(){var a=this.innerHTML,a=a.replace(/\s{2,}/g,""),a=a.replace(/\{\{(.*?)\}\}/g,"',$1,'"),a=a.split("{%").join("');"),a=a.split("%}").join("a.push('"),
a="var a=[];a.push('{}');return a.join('');".format(a);this.source=new Function(a)}},render:{value:function(a){return this.source.call(a)}}}),"extends":"template"});var r=e.Collection=d.registerElement("hb-collection",{prototype:Object.create(HTMLElement.prototype,{load:{value:function(a){this.id=a.id;this.handle=a.handle;this.title=a.title;this.type=a.type;this.template=f[a.type];this.blocks=a.blocks.map(function(a){return new s(a)});void 0!==this.template?this.insertAdjacentHTML("beforeend",this.template.render(this)):
console.error("Template '{}' is not defined".format(a.type))}}})}),s=e.Block=g({constructor:function(a){for(var c in a)this[c]=a[c];this.time=new Date(this.time);this.template=f[this.type]},reduce:function(a){a=a.split(".");var c=this[a[0]];if(void 0!==a[1])for(var b=1;b<a.length;b++)c=c[a[b]];return c}}),t=e.Router=g({constructor:function(){f.addEventListener("hashchange",this.match.bind(this),!1)},add$hidden:function(a,c){this[a]=c;this[a].match=new RegExp(a.replace(/:\w+/g,"(\\w+)"))},match$hidden:function(){var a=
!0,c;for(c in this){var b=location.hash.match(this[c].match);null!==b&&(b.shift(),this[c].apply(this,b),a=!1)}a&&void 0!==this._fallback&&this._fallback()},fallback$hidden:{set:function(a){this._fallback=a}}});e.router=new t;var q=e.Request=g({constructor:function c(b){this.endpoint=b;this.xhr=new XMLHttpRequest;this.xhr.addEventListener("load",c.load.bind(this),!1)},get:function(c,b){this.callback=b;this.xhr.open("GET",this.endpoint.format(c),!0);this.xhr.setRequestHeader("Accept","application/json");
this.xhr.send(null);d.body.classList.add("loading")},load$static:function(){200===this.xhr.status&&this.callback.call(this,JSON.parse(this.xhr.response));d.body.classList.remove("loading")}});String.prototype.format=function(c){var b=0;"object"!==typeof c&&(c=[].slice.call(arguments));return this.replace(/:(\w+)|\{([0-9])?\}/g,function(d,e,f){return c[e||f||b++]})};Date.prototype.format=function(c){var b=Date.ordinals,d=this.getDate(),e=this.getDay(),f=this.getMonth(),g=this.getFullYear(),h=this.getHours(),
k=h%12||12,l=this.getMinutes(),m=this.getSeconds(),p={d:10>d?"0"+d:d,D:Date.days[e].substr(0,3),j:d,l:Date.days[e],N:e||7,S:3<d&&20>=d?b[0]:b[d%10]||b[0],w:e,F:Date.months[f],m:10>f?"0"+(f+1):f+1,M:Date.months[f].substr(0,3),n:f+1,t:(new Date(g,f+1,0)).getDate(),Y:g,y:(""+g).substr(2,2),a:12>h?"am":"pm",A:12>h?"AM":"PM",g:k,G:h,h:10>k?"0"+k:k,H:10>h?"0"+h:h,i:10>l?"0"+l:l,s:10>m?"0"+m:m};return c.replace(/\\?([a-z])/gi,function(b,c){return void 0!==p[b]?p[b]:c})};Date.ordinals=["th","st","nd","rd"];
Date.days="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");Date.months="January February March April May June July August September October November December".split(" ")})(this);