(function(f){var d=f.document,l=f.location,g=Object.defineProperty,k=Object.create,e=f.HB={version:"2.0.0",endpoint:"api/:handle",collections:{},main:function(){this.request=new r(this.endpoint);this.home=d.links[0].hash;this.root=f.root;this.title={text:d.title,spec:d.getElementsByTagName("title")[0].dataset.spec};this.router.fallback=function(){l.hash=e.home};this.router.add("/:collection",function(a){void 0===e.collections[a]?e.request.get({handle:a},function(b){e.collections[a]=new s;e.collections[a].load(b);
e.root.appendChild(e.collections[a])}):e.root.appendChild(e.collections[a])});this.router.match()}},h=f.klass=function(a){var b=a.constructor;void 0!==this.prototype&&(b.prototype=k(this.prototype,{parent:{value:this.prototype}}));for(var c in a){var n=c.split("$")[0],d=/\$static/.test(c)?b:b.prototype,e=!/\$hidden|constructor/.test(c);void 0!==a[c].get||void 0!==a[c].set?g(d,n,{enumerable:e,get:a[c].get,set:a[c].set}):g(d,n,{enumerable:e,value:a[c]})}return b};g(Object.prototype,"extend",{value:h});
void 0===d.registerElement&&(d.registerElement=function(a,b){d.registerElement.elements[a]=b;var c=function(){var c=d.createElement(a);c.__proto__=b.prototype;void 0!==c.createdCallback&&c.createdCallback.call(a);return c};c.prototype=b.prototype;g(c.prototype,"constructor",{value:c});return c},d.registerElement.elements={},d.addEventListener("DOMContentLoaded",function(){var a=d.registerElement.elements,b;for(b in a){var c=a[b]["extends"]?"{}[is={}]".format(a[b]["extends"],b):b;Array.apply(null,
d.querySelectorAll(c)).forEach(function(c){c.__proto__=a[b].prototype;void 0!==c.attachedCallback&&c.attachedCallback.call(c)})}},!1));void 0===f.HTMLTemplateElement&&(f.HTMLTemplateElement=HTMLElement.extend({constructor:function(){this.parent.constructor.apply(this,arguments)}}));e.Template=d.registerElement("hb-template",{prototype:k(f.HTMLTemplateElement.prototype,{attachedCallback:{value:function(){var a=this.innerHTML,a=a.replace(/\s{2,}/g,""),a=a.replace(/\{\{(.*?)\}\}/g,"',$1,'"),a=a.split("{%").join("');"),
a=a.split("%}").join("a.push('"),a="var a=[];a.push('{}');return a.join('');".format(a);this.source=new Function(a)}},render:{value:function(a){return this.source.call(a)}}}),"extends":"template"});var s=e.Collection=d.registerElement("hb-collection",{prototype:k(HTMLElement.prototype,{load:{value:function(a){this.id=a.id;this.handle=a.handle;this.title=a.title;this.type=a.type;this.template=f[a.type];this.blocks=a.blocks.map(function(a){return new t(a)});void 0!==this.template?this.insertAdjacentHTML("beforeend",
this.template.render(this)):console.error("Template '{}' is not defined".format(a.type))}}})}),t=e.Block=h({constructor:function(a){for(var b in a)this[b]=a[b];this.time=new Date(this.time);this.template=f[this.type]},reduce:function(a){a=a.split(".");var b=this[a[0]];if(void 0!==a[1])for(var c=1;c<a.length;c++)b=b[a[c]];return b}}),u=e.Router=h({constructor:function(){f.addEventListener("hashchange",this.match.bind(this),!1)},add$hidden:function(a,b){this[a]=b;this[a].match=new RegExp(a.replace(/:\w+/g,
"(\\w+)"))},match$hidden:function(){var a=!0,b;for(b in this){var c=l.hash.match(this[b].match);null!==c&&(c.shift(),this[b].apply(this,c),a=!1)}a&&void 0!==this._fallback&&this._fallback()},fallback$hidden:{set:function(a){this._fallback=a}}});e.router=new u;var r=e.Request=h({constructor:function(a){this.endpoint=a;this.xhr=new XMLHttpRequest;this.xhr.addEventListener("load",this.load.bind(this),!1)},get:function(a,b){this.callback=b;this.xhr.open("GET",this.endpoint.format(a),!0);this.xhr.setRequestHeader("Accept",
"application/json");this.xhr.send(null);d.body.classList.add("loading")},load:function(){200===this.xhr.status&&this.callback(JSON.parse(this.xhr.response));d.body.classList.remove("loading")}});String.prototype.format=function(a){var b=0;"object"!==typeof a&&(a=[].slice.call(arguments));return this.replace(/:(\w+)|\{([0-9])?\}/g,function(c,d,e){return a[d||e||b++]})};Date.prototype.format=function(a){var b=this.getDate(),c=this.getDay(),d=this.getMonth(),e=this.getFullYear(),f=this.getHours(),g=
f%12||12,h=this.getMinutes(),k=this.getSeconds(),l={d:10>b?"0"+b:b,D:p[c].substr(0,3),j:b,l:p[c],N:c||7,S:3<b&&20>=b?m[0]:m[b%10]||m[0],w:c,F:q[d],m:10>d?"0"+(d+1):d+1,M:q[d].substr(0,3),n:d+1,t:(new Date(e,d+1,0)).getDate(),Y:e,y:(""+e).substr(2,2),a:12>f?"am":"pm",A:12>f?"AM":"PM",g:g,G:f,h:10>g?"0"+g:g,H:10>f?"0"+f:f,i:10>h?"0"+h:h,s:10>k?"0"+k:k};return a.replace(/\\?([a-z])/gi,function(a,b){return void 0!==l[a]?l[a]:b})};var m=Date.ordinals=["th","st","nd","rd"],p=Date.days="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
q=Date.months="January February March April May June July August September October November December".split(" ");void 0===d.documentElement.dataset&&Object.defineProperty(Element.prototype,"dataset",{get:function(){var a={};Array.apply(null,this.attributes).forEach(function(b){var c=b.name.split("-");void 0!==c[1]&&"data"===c[0]&&(a[c[1]]=b.value)});return a}})})(this);