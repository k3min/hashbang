(function(e){var f=e.document,n=e.location,g=Object.defineProperty,l=Object.create,d=e.HB={version:"2.0.0",endpoint:"api/:handle",collections:{},main:function(){this.request=new s(this.endpoint);this.home=f.links[0].hash;this.root=e.root;this.title={text:f.title,spec:f.getElementsByTagName("title")[0].dataset.spec};this.router.fallback=function(){n.hash=d.home};this.router.add("/:collection",function(a){void 0===d.collections[a]?d.request.get({handle:a},function(b){d.collections[a]=new t;d.collections[a].load(b);
d.root.appendChild(d.collections[a])}):d.root.appendChild(d.collections[a])});this.router.match()}},k=e.klass=function(a){var b=a.constructor;void 0!==this.prototype&&(b.prototype=l(this.prototype,{parent:{value:this.prototype}}));for(var c in a){var d=c.split("$")[0],f=/\$static/.test(c)?b:b.prototype,e=!/\$hidden|constructor/.test(c);void 0!==a[c].get||void 0!==a[c].set?g(f,d,{enumerable:e,get:a[c].get,set:a[c].set}):g(f,d,{enumerable:e,value:a[c]})}return b};g(Object.prototype,"extend",{value:k});
if(void 0===f.registerElement){var h={},p=function(a,b){/MSIE 10/.test(navigator.appVersion)?Array.apply(null,Object.getOwnPropertyNames(b)).forEach(function(c){"constructor"!==c&&g(a,c,{value:b[c]})}):a.__proto__=b};f.registerElement=function(a,b){h[a]=b;var c=function(){var c=f.createElement(a);p(c,b.prototype);return c};c.prototype=b.prototype;g(c.prototype,"constructor",{value:c});return c};f.addEventListener("DOMContentLoaded",function(){for(var a in h){var b=h[a]["extends"]?"{}[is={}]".format(h[a]["extends"],
a):a;Array.apply(null,f.querySelectorAll(b)).forEach(function(b){p(b,h[a].prototype);void 0!==b.attachedCallback&&b.attachedCallback.call(b)})}},!1)}void 0===e.HTMLTemplateElement&&(e.HTMLTemplateElement=HTMLElement.extend({constructor:function(){this.parent.constructor.apply(this,arguments)}}));d.Template=f.registerElement("hb-template",{prototype:l(e.HTMLTemplateElement.prototype,{attachedCallback:{value:function(){var a=this.innerHTML,a=a.replace(/\s{2,}/g,""),a=a.replace(/\{\{(.*?)\}\}/g,"',$1,'"),
a=a.split("{%").join("');"),a=a.split("%}").join("a.push('"),a="var a=[];a.push('{}');return a.join('');".format(a);this.source=new Function(a)}},render:{value:function(a){return this.source.call(a)}}}),"extends":"template"});var t=d.Collection=f.registerElement("hb-collection",{prototype:l(HTMLElement.prototype,{load:{value:function(a){this.id=a.id;this.handle=a.handle;this.title=a.title;this.type=a.type;this.template=e[a.type];this.blocks=a.blocks.map(function(a){return new u(a)});void 0!==this.template?
this.insertAdjacentHTML("beforeend",this.template.render(this)):console.error("Template '{}' is not defined".format(a.type))}}})}),u=d.Block=k({constructor:function(a){for(var b in a)this[b]=a[b];this.time=new Date(this.time);this.template=e[this.type]},reduce:function(a){a=a.split(".");var b=this[a[0]];if(void 0!==a[1])for(var c=1;c<a.length;c++)b=b[a[c]];return b}}),v=d.Router=k({constructor:function(){e.addEventListener("hashchange",this.match.bind(this),!1)},add$hidden:function(a,b){this[a]=b;
this[a].match=new RegExp(a.replace(/:\w+/g,"(\\w+)"))},match$hidden:function(){var a=!0,b;for(b in this){var c=n.hash.match(this[b].match);null!==c&&(c.shift(),this[b].apply(this,c),a=!1)}a&&void 0!==this._fallback&&this._fallback()},fallback$hidden:{set:function(a){g(this,"_fallback",{value:a})}}});d.router=new v;var s=d.Request=k({constructor:function(a){this.endpoint=a;this.xhr=new XMLHttpRequest;this.xhr.addEventListener("load",this.load.bind(this),!1)},get:function(a,b){this.callback=b;this.xhr.open("GET",
this.endpoint.format(a),!0);this.xhr.setRequestHeader("Accept","application/json");this.xhr.send(null);f.body.classList.add("loading")},load:function(){200===this.xhr.status&&this.callback(JSON.parse(this.xhr.response));f.body.classList.remove("loading")}});String.prototype.format=function(a){var b=0;"object"!==typeof a&&(a=[].slice.call(arguments));return this.replace(/:(\w+)|\{([0-9])?\}/g,function(c,d,f){return a[d||f||b++]})};Date.prototype.format=function(a){var b=this.getDate(),c=this.getDay(),
d=this.getMonth(),f=this.getFullYear(),e=this.getHours(),g=e%12||12,h=this.getMinutes(),k=this.getSeconds(),l={d:10>b?"0"+b:b,D:q[c].substr(0,3),j:b,l:q[c],N:c||7,S:3<b&&20>=b?m[0]:m[b%10]||m[0],w:c,F:r[d],m:10>d?"0"+(d+1):d+1,M:r[d].substr(0,3),n:d+1,t:(new Date(f,d+1,0)).getDate(),Y:f,y:(""+f).substr(2,2),a:12>e?"am":"pm",A:12>e?"AM":"PM",g:g,G:e,h:10>g?"0"+g:g,H:10>e?"0"+e:e,i:10>h?"0"+h:h,s:10>k?"0"+k:k};return a.replace(/\\?([a-z])/gi,function(a,b){return void 0!==l[a]?l[a]:b})};var m=Date.ordinals=
["th","st","nd","rd"],q=Date.days="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),r=Date.months="January February March April May June July August September October November December".split(" ");void 0===f.documentElement.dataset&&g(Element.prototype,"dataset",{get:function(){var a={};Array.apply(null,this.attributes).forEach(function(b){var c=b.name.split("-");void 0!==c[1]&&"data"===c[0]&&(a[c[1]]=b.value)});return a}})})(this);